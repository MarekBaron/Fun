INTEGER FUNCTION TGA_810(XTGA,ARRAY_810);
CHARACTER (256) XTGA,TGA,ARRAY_810(2);
CHARACTER (64) S,Mask(5);
CHARACTER(12) Temp;
Character(5) S16,S40,S45,S70,S71,S76,D5F,D5N,D3F,D3N,GNR,TYP;
INTEGER I40,I45,I70,I71,L,BH,BL;
LOGICAL L70,L71,B1,B2,L40,L45;
Temp='ala ma "kota"';
GNR='PH0';
D3F='???';
D3N='000';
D5F='?????';
D5N='00000';
Mask(1:5)=(/'x-x----------','--------xx---','--------xx---','--------xx---','-----------xx'/);
TGA=VDISTRING('&|&',XTGA,'??????????????????????????????????????????????????????????');
S16=VDICSTRING(TGA,0,7,9);
S40=VDICSTRING(TGA,0,28,30);
S45=VDICSTRING(TGA,0,31,33);
S70=VDICSTRING(TGA,0,46,50);
S76=VDICSTRING(TGA,0,51,53);
S71=VDICSTRING(TGA,0,54,58);
L40=S40==D3F .OR. S40==D3N;
L45=S45==D3F .OR. S45==D3N;
L70=S70==D5F .OR. S70==D5N;
L71=S71==D5F .OR. S71==D5N;
IF(L40)S40='0';
IF(L45)S45='0';
IF(L70)S70='1';
IF(L71)S71='0';
I40=VDIISTRING(S40,0,0,0);
I45=VDIISTRING(S45,0,0,0);
I70=VDIISTRING(S70,0,0,0);
I71=VDIISTRING(S71,0,0,0);
IF(ARRAY_810(1))then;
   I40=1**0;
   I45=0;
else;
   I40=VDIISTRING(S40,0,0,0);
   B1=I40<6 .and. I45>0 .and. I45<14;
   if(B1)then;
      S=VDICSTRING(Mask(I40),Mask(1),I45,I45);
      B2=s=='-';
      IF(B2)then;
         I40=1;
         I45=0;
      elseif(B1)then;
         I40=2;
      endif;
   else;
      I40=1;
      I45=0;
   endif;
endif;
END FUNCTION TGA_810;