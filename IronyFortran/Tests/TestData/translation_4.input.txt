INTEGER FUNCTION TGA_810(XTGA,ARRAY_810);
CHARACTER (256) TGA,XTGA,ARRAY_810(2);
CHARACTER (64) S,Best;
Character (6) D3F,D5F,D3N,D5N,S16,S30,S40,S45,S70,S71,Typ,Stelle12(8),Stelle13(8);
INTEGER I16,I30,I40,I45,I70,I71,BL,BH,arI40(8),arI45(16),I,J,K,L,A,E;
Integer Stelle10(8);
LOGICAL L16,L30,L40,L45,L70,L71,B1,ok;
D3F='???';
D5F='?????';
D3N='000';
D5N='00000';
arI40(1:5)=(/10,11,16,18,28/);
arI45(1:10)=(/1,2,3,4,5,6,5,6,11,12/);
Stelle10(1:8)=(/1,2,3,2,5,5,5,5/);
Stelle12(1:8)=(/'1','1','1','Q','Q','Q','S','Q'/);
Stelle13(1:8)=(/'0','0','0','6','1','6','1','3'/);
TGA=VDISTRING('&|&',XTGA,'??????????????????????????????????????????????????????????');
S16=VDICSTRING(TGA,0,7,9);
S30=VDICSTRING(TGA,0,19,21);
S40=VDICSTRING(TGA,0,28,30);
S45=VDICSTRING(TGA,0,31,33);
S70=VDICSTRING(TGA,0,46,50);
S71=VDICSTRING(TGA,0,54,58);
L16=S16==D3F .OR. S16==D3N;
L30=S30==D3F .OR. S30==D3N;
L40=S40==D3F .OR. S40==D3N;
L45=S45==D3F .OR. S45==D3N;
L70=S70==D5F .OR. S70==D5N;
L71=S71==D5F .OR. S71==D5N;
if(L16)S16='1';
I16= VDIISTRING(S16,0,0,0);
B1=I16<1 .or. I16>14;
if(B1)I16=1;
IF(L30)S30='1';
I30= VDIISTRING(S30,0,0,0);
B1=I30<1 .or. I30>4;
if(B1)I30=1;
if(L40)S40='10';
I40= VDIISTRING(S40,0,0,0);
B1=.true.;
I=1;
do while (B1);
ok=I40==arI40(I);
if(OK)then;
B1=.false.;
else;
I=I+1;
B1=I<6;
endif;
enddo;
OK=.not.OK;
if(OK)I=1;
if(L45)then;
I45=arI45((I-1)*2+1);
else;
I45= VDIISTRING(S45,0,0,0);
endif;
B1=.true.;
J=(I-1)*2+1;
K=J;
Do While (B1);
OK=I45==arI45(J);
if(ok)then;
B1=.false.;
else;
J=J+1;
B1=j<K+2;
endif;
endDo;
Ok=.not.OK;
if(Ok)J=K;
I40=arI40(I);
I45=arI45(J);
IF(L70)S70='1';
I70= VDIISTRING(S70,0,0,0);
B1= I70<1 .or. I70>126;
if(B1)I70=1;
A=VdiErster('700',I70,'710.01');
E=VdiLetzter('700',I70,'710.01');
if(L71)then;
I71=A;
else;
I71= VDIISTRING(S71,0,0,0);
endif;
B1=I71<A .or. I71>E;
if(B1)I71=A;
BL=VdiIWert('700',I70,'710.01',I71,3);
BH=VdiIWert('700',I70,4);
Typ=VdiCWert('700',I70,6,L);
S=VdiString('D1$$$$~##',Typ,BL/50);
Best=VdiString('D1$~###~#|#0$|$0A0',VdiCString(Typ,0,1,1),BH,BL/50,Stelle10(I),Stelle12(I),Stelle13(I));
TGA_810=2;
ARRAY_810(1)=VDISTRING('810\;1\;&\;&\;',Best,S);
ARRAY_810(2)='810\;2\;';
XTGA=VDISTRING('003001~##001000000~##000000~##~##000001000000~####000~####',I16,I30,I40,I45,I70,I71);
END FUNCTION TGA_810;
