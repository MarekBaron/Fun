CHARACTER(58) FUNCTION JoinTgaNr(iTgaNr);
CHARACTER(58) sTgaNrNew;
CHARACTER(5) sTgaPart;
INTEGER iTgaNr(1:18);
INTEGER iCounter;
LOGICAL bIsTrue, bContinue;
iCounter=1;
bContinue=.TRUE.;
DO WHILE (bContinue);
bIsTrue=(iTgaNr(iCounter) >=0);
IF (bIsTrue) THEN;
sTgaPart=VDISTRING('~##', iTgaNr(iCounter));
ELSE;
sTgaPart='???';
ENDIF;
sTgaNrNew=VDISTRING('&|&', sTgaNrNew, sTgaPart);
iCounter=iCounter + 1;
bContinue=(iCounter < 16);
ENDDO;
bIsTrue=(iTgaNr(16) >=0);
IF (bIsTrue) THEN;
sTgaPart=VDISTRING('~####', iTgaNr(16));
ELSE;
sTgaPart='?????';
ENDIF;
sTgaNrNew=VDISTRING('&|&', sTgaNrNew, sTgaPart);
bIsTrue=(iTgaNr(17) >=0);
IF (bIsTrue) THEN;
sTgaPart=VDISTRING('~##', iTgaNr(17));
ELSE;
sTgaPart='???';
ENDIF;
sTgaNrNew=VDISTRING('&|&', sTgaNrNew, sTgaPart);
bIsTrue=(iTgaNr(18) >=0);
IF (bIsTrue) THEN;
sTgaPart=VDISTRING('~####', iTgaNr(18));
ELSE;
sTgaPart='?????';
ENDIF;
sTgaNrNew=VDISTRING('&|&', sTgaNrNew, sTgaPart);
JoinTgaNr=sTgaNrNew;
END FUNCTION JoinTgaNr;
LOGICAL FUNCTION FindPointer(sRecType, iIdx700, iIdxParent, iPointer);
CHARACTER(6) sRecType;
INTEGER iPointer, iIdx700, iIdxParent;
INTEGER iIdx, iLenStr;
LOGICAL bOK, bExit, bFound, bFirst, bFindParent, bContinue, bIsTrue;
iPointer=0;
bOK=.FALSE.;
iIdx=0;
bFound=.FALSE.;
bExit=.FALSE.;
bFirst=.TRUE.;
bFindParent=(iIdxParent > 0);
bContinue=.TRUE.;
DO WHILE(bContinue);
IF (bFirst) THEN;
iIdx=VDIERSTER('700', iIdx700, '710.05');
bFirst=.FALSE.;
ELSE;
iIdx=VDIFOLGE('700', iIdx700, '710.05', iIdx);
ENDIF;
bIsTrue=(iIdx > 0);
IF (bIsTrue) THEN;
bFound=(VDICWERT('700', iIdx700, '710.05', iIdx, 4, iLenStr) == sRecType);
IF (bFound) THEN;
IF (bFindParent) THEN;
bFound=(VDIIWERT('700', iIdx700, '710.05', iIdx, 7) == iIdxParent);
ENDIF;
ENDIF;
IF (bFound) THEN;
iPointer=iIdx;
bOK=.TRUE.;
ENDIF;
bExit=(bFound .OR. (iLenStr == 0));
ELSE;
bExit=.TRUE.;
ENDIF;
bContinue=(.NOT. bExit);
ENDDO;
FindPointer=bOK;
END FUNCTION FindPointer;
